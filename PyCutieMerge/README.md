## CutieMerge: Скачивание и объединение серий My Little Pony

CutieMerge - это приложение на Python, которое позволяет скачивать и объединять серии мультсериала "My Little Pony: Friendship is Magic" с сайта магиядружбы.рф.

### Возможности:

- Выбор сезона и серии.
    
- Выбор качества видео (4K, 2K, Full HD, HD, и другие).
    
- Выбор озвучки (оригинальная, русские и другие).
    
- Выбор субтитров (русские, английские и другие).
    
- Автоматическое объединение видео, аудио и субтитров в файл MKV.
    
- Удаление временных файлов после объединения.

- Настройки программы с помощью конфигурационного файла
    

### Требования:

- [ffmpeg](https://www.ffmpeg.org/): Необходимо скачать и установить ffmpeg для объединения видео, аудио и субтитров.
    

### Использование:

1. **Скачайте файл CutieMerge.exe.**
    
2. **Запустите приложение CutieMerge.exe.**
    
3. **Следуйте инструкциям в консоли:**
    
    - Введите номер сезона (1-9).
        
    - Выберите номер серии из списка.
        
    - Выберите качество видео.
        
    - Выберите озвучку.
        
    - Выберите субтитры.
        
    - Подтвердите свой выбор.
        
4. **Дождитесь завершения загрузки и объединения.**
    
5. **Объединенный файл MKV будет сохранен в папке "CutieMerge" в директории загрузок.**


### Команды

**!!** Ввод команды доступен только во время выбора сезона или серии. Вводите команды вместо запрашиваемого значения. Ошибка 'cannot access local variable 'season' where it is not associated with a value' после выхода из меню команды - норма, обращайте внимание на желтые логи, они укажут, подействовала команда или нет.

2. **/settings** - команда настроек. При первом вводе автоматически создаст конфигурационный файл в папке с программой. Советуем выделить отдельную папку для программы.

    - **Максимальное количество попыток загрузки.** Указывает максимальное количество повторных загрузок при сбое загрузки одного из чанков. Значение по умолчанию - 3, рекомендуемый промежуток значений: 2-5.
  
    - **Количество потоков загрузки**. Указывает количество потоков для деления файла на фрагменты (чанки). Действует по формуле 'Размер файла / кол-во потоков = кол-во чанков'. Значение по умолчанию - 4, рекомендуемый промежуток значений: 2-8. Для скорости интернета в 100 мбит/c (10 мб/c) используйте стандартное значение. Если скорость вашего интернета выше - пробуйте значения выше, знайте, что за стабильную работу считается тот случай, когда загрузка замедляется (примерно до 300 кб/c) только на последних ~100-50 мб. Если загрузка замедляется уже на предпоследнем чанке (высчитайте по формуле) или раньше, это повод уменьшить количество потоков; однако вы можете попробовать подождать, возможно скорость вернется к нормальному значению и не будет падать до самого конца, это тоже можно считать стабильной работой. Учитывайте, что за слишком большое кол-во чанков сервер может отклонить вашу загрузку, а то и вовсе заблокировать ваш айпи, не стоит выходить за рамки выше рекомендуемого значения. Также не указывайте значение 1, вместо этого лучше воспользуйтесь альтернативным загрузчиком
    

### Возможные ошибки и их решения:

- **Ошибка при проверке доступности API:**
    
    - **Причина:** Сайт магиядружбы.рф недоступен или возникли проблемы с интернет-соединением.
        
    - **Решение:** Проверьте ваше интернет-соединение и попробуйте позже.
        
- **Ошибка при скачивании видео/аудио/субтитров:**
    
    - **Причина:** Файл недоступен на сервере или возникли проблемы с интернет-соединением.
        
    - **Решение:** Проверьте ваше интернет-соединение и попробуйте позже. Если проблема сохраняется, возможно, файл был удален с сервера.

- **Синий экран смерти ndis.sys**

    - **Информация:** Программа взаимодействует с сетевыми узлами для скачивания файлов серии. При этом никак не изменяя драйвер, ответственный за сетевые коммуникации на вашем компьютере. Если у вас возникла эта проблема, не переживайте, компьютер сам перезагрузится и вернется в стабильное состояние, ваши данные не пострадают

    - **Причина:** Устаревшее сетевое оборудование вашего компьютера. Низкая скорость интернета

    - **Решение:** Установить меньшее количество потоков для загрузки, либо воспользоваться альтернативным загрузчиком (ALT версия программы, идет отдельно в релизе), который не использует деление на потоки.
        
- **Ошибка при объединении видео:**
    
    - **Причина:** Ошибка в ffmpeg или несовместимость выбранных файлов.
        
    - **Решение:** Убедитесь, что ffmpeg установлен правильно. Проверьте, что выбранные видео, аудио и субтитры совместимы (например, разрешение видео и формат субтитров).
        
- **Ошибка: [WinError 5] Отказано в доступе:**
    
    - **Причина:** Программа пытается получить доступ к файлу или папке, на что у нее нет прав.
        
    - **Решение:** Запустите программу от имени администратора.

- **Ошибка после ввода команды /settings:**

    - **Причина:** Возможно у вас есть другой конфигурационный файл (config.ini) в папке с программой
 
    - **Решение:** Удалите или переместите лишний конфигурационный файл. Создайте для программы отдельную папке.

 - **Программа не запускается / сразу вылетает:**

    - **Причина:** Возможно, у вас не установлен ffmpeg. Также причиной может быть конфликт с другими файлами.
  
    - **Решение:** Установите ffmpeg, желательно по стандартным параметрам, которые указаны в установщике, убедитесь, что он доступен в PATH. Переместите файл программы (.exe) в отдельную папку, созданную отдельно для нее. 

- **Конечное видео содержит артефакты:**

    - **Причина:** Скорее всего ошибка в самой программе, либо при объединении.
 
    - **Решение:** Попробуйте сбилдить эту же серию еще раз, если ошибка сохранится, напишите соответствующий баг репорт, приложив логи и вывод программы.


### Дополнительная информация:

- Программа использует многопоточную загрузку для ускорения процесса скачивания. Скачивание может сильно замедллится под конец, это нормально

- Директория конечного файла откроется автоматически, чтобы вам не пришлось искать
